var $j = jQuery.noConflict();
$j(document).ready(function () {
    dropDownMenu();
    setDropDownMenuPosition();
    dropDownMenu2();
    selectMenu();
    initAccordion();
    initAccordionFullWidth();
    initProgressBars();
    initCounter();
    initTabs();
    initMessages();
    setFooterHeight();
    initFlexSlider();
    backButtonInterval();
    backToTop();
    fitVideo();
    accordionFullWidth();
    topAreaLine();
    viewPort();
    initParallax(parallax_speed);
    parallaxPager();
    selectBox();
    initFadeDownEffect();
    initDoughnutChart();
    initToCounter();
    placeholderReplace();
    addPlaceholderSearchWidget();
    prettyPhoto();
    loadMore();
    initAccordionContentLink()
});
$j(window).scroll(function () {
    var a = $j(window).scrollTop();
    if ($j(window).width() > 768 && $j(".no_fixed").length === 0) {
        headerSize(a)
    }
});
$j(window).resize(function () {
    setBlogPortfolioListHeight();
    accordionFullWidth();
    topAreaLine();
    setDropDownMenuPosition();
    setSidebarBackgroundColor();
    checkLogOnSmallestSize()
});

function dropDownMenu() {
    var a = $j(".no-touch .drop_down > ul > li");
    a.each(function (b) {
        if ($j(a[b]).find(".second").length > 0) {
            $j(a[b]).data("original_height", $j(a[b]).find(".second").height() + "px");
            $j(a[b]).find(".second").hide();
            $j(a[b]).mouseenter(function () {
                $j(a[b]).find(".second").css({
                    visibility: "visible",
                    height: "0px",
                    opacity: "0",
                    display: "block"
                });
                $j(a[b]).find(".second").stop().animate({
                    height: $j(a[b]).data("original_height"),
                    opacity: 1
                }, 400, function () {
                    $j(a[b]).find(".second").css("overflow", "visible")
                });
                dropDownMenuThirdLevel()
            }).mouseleave(function () {
                $j(a[b]).find(".second").stop().animate({
                    height: "0px"
                }, 0, function () {
                    $j(a[b]).find(".second").css({
                        overflow: "hidden",
                        visivility: "hidden",
                        display: "none"
                    })
                })
            })
        }
    })
}

function setDropDownMenuPosition() {
    var a = $j(".drop_down > ul > li");
    a.each(function (e) {
        var d = $j(window).width();
        var b = $j(a[e]).offset().left;
        var f = $j(".drop_down .second .inner2 ul").width();
        var c = d - b + 30;
        var g;
        if ($j(a[e]).find("li.sub").length > 0) {
            g = d - b - f + 30
        }
        if (c < f || g < f) {
            $j(a[e]).find(".second").addClass("right");
            $j(a[e]).find(".second .inner .inner2 ul").addClass("right")
        }
    })
}

function dropDownMenu2() {
    var a = $j(".header_right_widget").width();
    var b = -1000 - a;
    $j(".drop_down2 .second").css({
        "margin-left": b,
        "margin-right": b
    });
    $j(".no-touch .drop_down2 > ul > li").each(function () {
        var c = $j(this).find(".second").height();
        $j(this).mouseenter(function () {
            $j(this).find(".second").height(0);
            $j(this).find(".second").css({
                visibility: "visible",
                "z-index": "100"
            });
            $j(this).find(".second").stop().animate({
                height: c + 20
            }, 400)
        }).mouseleave(function () {
            $j(this).find(".second").css("z-index", "90");
            $j(this).find(".second").stop().animate({
                height: 0
            }, 400, function () {
                $j(this).css("visibility", "hidden");
                $j(this).height(0)
            })
        })
    })
}

function dropDownMenuThirdLevel() {
    var a = $j(".no-touch .drop_down ul li > .second > .inner > .inner2 > ul > li");
    a.each(function (b) {
        if ($j(a[b]).find("ul").length > 0) {
            var c = 0;
            $j(a[b]).find("ul li").each(function () {
                c += $j(this).height()
            });
            $j(a[b]).data("original_height", c + "px");
            var d = $j(a[b]).find("ul > li").size() * 10 + 100;
            $j(a[b]).mouseenter(function () {
                $j(a[b]).find("ul").css({
                    visibility: "visible",
                    height: "0px",
                    opacity: "0",
                    display: "block",
                    padding: "10px 0"
                });
                $j(a[b]).find("ul").stop().animate({
                    height: $j(a[b]).data("original_height"),
                    opacity: 1
                }, d, function () {
                    $j(a[b]).find("ul").css("overflow", "visible")
                })
            }).mouseleave(function () {
                $j(a[b]).find("ul").stop().animate({
                    height: "0px"
                }, 0, function () {
                    $j(a[b]).find("ul").css({
                        overflow: "hidden",
                        padding: "0"
                    });
                    $j(a[b]).find(".second").css("visivility", "hidden")
                })
            })
        }
    })
}

function selectMenu() {
    var a = $j("<div class='select'><ul></ul></div>");
    a.appendTo(".selectnav");
    if ($j(".main_menu").hasClass("drop_down")) {
        $j(".main_menu ul li a").each(function () {
            var c = $j(this).attr("href");
            var b = $j(this).text();
            if ($j(this).parents("li").length === 2) {
                b = "   " + b
            }
            if ($j(this).parents("li").length === 3) {
                b = "      " + b
            }
            if ($j(this).parents("li").length > 3) {
                b = "         " + b
            }
            var d = $j("<li />");
            var e = $j("<a />", {
                href: c,
                html: b
            });
            e.appendTo(d);
            d.appendTo(a.find("ul"))
        })
    } else {
        if ($j(".main_menu").hasClass("drop_down2")) {
            $j(".main_menu ul li a").each(function () {
                var c = $j(this).attr("href");
                var b = $j(this).text();
                if ($j(this).parents("div.mc").length === 1) {
                    b = "   " + b
                }
                if ($j(this).hasClass("sub")) {
                    b = "    " + b
                }
                var d = $j("<li />");
                var e = $j("<a />", {
                    href: c,
                    html: b
                });
                e.appendTo(d);
                d.appendTo(a.find("ul"))
            })
        }
    }
    $j(".selectnav_button span").click(function () {
        if ($j(".select ul").is(":visible")) {
            $j(".select ul").slideUp()
        } else {
            $j(".select ul").slideDown()
        }
    });
    $j(".selectnav ul li a").click(function () {
        $j(".select ul").slideUp()
    })
}

function initAccordionFullWidth() {
    $j(".accordion .accordion_inner").accordion({
        animate: "swing",
        collapsible: true,
        active: false,
        icons: "",
        heightStyle: "content"
    });
    $j(".accordion .accordion_inner").each(function () {
        $j(this).click(function () {
            if ($j(this).find("h4").hasClass("ui-state-active")) {
                $j(this).find("span.arrow").addClass("animate_arrow")
            } else {
                $j(this).find("span.arrow").removeClass("animate_arrow")
            }
        })
    })
}

function initProjects(b) {
    $j(".filter_holder").each(function () {
        var a = 0;
        $j(this).find("li.filter").each(function () {
            a += $j(this).height()
        });
        $j(this).on("click", function (e) {
            var c = $j(this),
                h = c.siblings(".hidden");
            if (!c.hasClass("expanded")) {
                c.find("ul").css("z-index", "10");
                c.find("ul").height(a + 30);
                c.addClass("expanded");
                var d = c.find(".label span");
                d.text(d.attr("data-label"))
            } else {
                c.find("ul").height(30);
                c.removeClass("expanded");
                var g = $j(e.target),
                    f = g.index();
                if ($j(e.target)[0].tagName === "li") {
                    c.find(".label span").text($(e.target).text())
                }
                if (h.length) {
                    h.find("option").removeAttr("selected").eq(f).attr("selected", "selected").change()
                }
            }
        })
    });
    $j(".filter_holder .filter").on("click", function () {
        var c = $j(this).text();
        var a = $j(".filter_holder").find(".label span");
        a.each(function () {
            $j(this).text(c)
        })
    });
    $j(".projects_holder").mixitup({
        showOnLoad: b,
        transitionSpeed: 600,
        minHeight: 150
    });
    $j(".projects_type1 > .mix ").each(function () {
        $j(this).hoverdir()
    })
}

function resetFilter() {
    var a = $j(".filter_holder").find(".label span");
    a.text(a.attr("data-label"));
    $j(".filter_holder").find("li.filter").removeClass("active")
}

function initBlog() {
    $j(".blog_holder_inner").mixitup({
        showOnLoad: "all",
        transitionSpeed: 600,
        minHeight: 150
    })
}

function setFooterHeight() {
    var a = Math.max.apply(null, $j(".footer_top .four_columns > div").map(function () {
        return $j(this).height()
    }).get());
    $j(".footer_top .four_columns > div").css("min-height", a)
}

function setSidebarBackgroundColor() {
    var a = $j(".two_columns_66_33.background_color_sidebar > .column1").height();
    $j(".two_columns_66_33.background_color_sidebar > .column2").css("min-height", a);
    var c = $j(".two_columns_75_25.background_color_sidebar > .column1").height();
    $j(".two_columns_75_25.background_color_sidebar > .column2").css("min-height", c);
    var d = $j(".two_columns_33_66.background_color_sidebar > .column2").height();
    $j(".two_columns_33_66.background_color_sidebar > .column1").css("min-height", d);
    var b = $j(".two_columns_25_75.background_color_sidebar > .column2").height();
    $j(".two_columns_25_75.background_color_sidebar > .column1").css("min-height", b)
}

function initElements() {
    $j(".element_from_left").each(function () {
        $j(this).appear(function () {
            $j(this).addClass("element_from_left_on")
        }, {
            accX: 0,
            accY: -150
        })
    });
    $j(".element_from_right").each(function () {
        $j(this).appear(function () {
            $j(this).addClass("element_from_right_on")
        }, {
            accX: 0,
            accY: -150
        })
    });
    $j(".element_from_top").each(function () {
        $j(this).appear(function () {
            $j(this).addClass("element_from_top_on")
        }, {
            accX: 0,
            accY: -150
        })
    });
    $j(".element_from_bottom").each(function () {
        $j(this).appear(function () {
            $j(this).addClass("element_from_bottom_on")
        }, {
            accX: 0,
            accY: -150
        })
    });
    $j(".element_transform").each(function () {
        $j(this).appear(function () {
            $j(this).addClass("element_transform_on")
        }, {
            accX: 0,
            accY: -150
        })
    })
}

function initFlexSlider() {
    $j(".flexslider").flexslider({
        animationLoop: true,
        controlNav: false,
        useCSS: false,
        pauseOnAction: true,
        pauseOnHover: true,
        slideshow: true,
        animation: "slides",

        animationSpeed: 600,
        slideshowSpeed: 8000,
        start: function () {
            setTimeout(function () {
                $j(".flexslider").fitVids()
            }, 100)
        }
    });
    $j(".flex-direction-nav a").click(function (a) {
        a.preventDefault();
        a.stopImmediatePropagation();
        a.stopPropagation()
    })
}

function setBlogPortfolioListHeight() {
    var a = Math.max.apply(null, $j(".blog_holder article.mix").map(function () {
        return $j(this).height()
    }).get());
    $j(".blog_holder article.mix").each(function () {
        $j(this).height(a)
    })
}

function initAccordion() {
    $j(".accordion").accordion({
        animate: "swing",
        collapsible: true,
        active: false,
        icons: "",
        heightStyle: "content"
    });
    $j(".toggle").addClass("accordion ui-accordion ui-accordion-icons ui-widget ui-helper-reset").find("h4").addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function () {
        $j(this).toggleClass("ui-state-hover")
    }).click(function () {
        $j(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").next().toggleClass("ui-accordion-content-active").slideToggle(200);
        return false
    }).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide()
}

function initProgressBars() {
    $j(".progress_bars").each(function () {
        $j(this).appear(function () {
            $j(this).find(".progress_bar").each(function () {
                var a = $j(this).find(".progress_content").data("percentage");
                $j(this).find(".progress_content").css("width", "0%");
                $j(this).find(".progress_number").css("width", "0%");
                $j(this).find(".progress_content").animate({
                    width: a + "%"
                }, 2000);
                $j(this).find(".progress_number").html(a + "%");
                $j(this).find(".progress_number").animate({
                    width: "33px"
                }, 1800)
            })
        })
    })
}

function initTabs() {
    var a = $j(".tabs-nav");
    var b = a.children("li");
    a.each(function () {
        var c = $j(this);
        c.next().children(".tab-content").stop(true, true).hide().first().show();
        c.children("li").first().addClass("active").stop(true, true).show()
    });
    b.on("click", function (c) {
        var d = $j(this);
        d.siblings().removeClass("active").end().addClass("active");
        d.parent().next().children(".tab-content").stop(true, true).hide().siblings(d.find("a").attr("href")).fadeIn();
        c.preventDefault()
    })
}

function initCounter() {
    $j(".counter").each(function () {
        $j(this).appear(function () {
            $j(this).absoluteCounter({
                speed: 2000,
                fadeInDelay: 2000
            })
        })
    })
}
var $scrollHeight;

function initPortfolioSingleInfo() {
    var b = $j(".portfolio_single_follow");
    if ($j(".portfolio_single_follow").length > 0) {
        var a = b.offset();
        $scrollHeight = $j(".portfolio_container").height();
        var d = $j(".portfolio_container").offset();
        var c = $j(window);
        var e = parseInt($j(".main_menu > ul > li > a").css("line-height"), 10);
        c.scroll(function () {
            if (c.width() > 960) {
                if (c.scrollTop() + e + 3 > a.top) {
                    if (c.scrollTop() + e + b.height() + 24 < d.top + $scrollHeight) {
                        b.stop().animate({
                            marginTop: c.scrollTop() - a.top + e
                        })
                    } else {
                        b.stop().animate({
                            marginTop: $scrollHeight - b.height() - 24
                        })
                    }
                } else {
                    b.stop().animate({
                        marginTop: 0
                    })
                }
            } else {
                b.css("margin-top", 0)
            }
        })
    }
}

function initMessages() {
    $j(".message").each(function () {
        $j(this).find(".close").click(function (a) {
            a.preventDefault();
            $j(this).parent().fadeOut(500)
        })
    })
}

function totop_button(d) {
    var c = $j("#back_to_top");
    c.removeClass("off on");
    if (d === "on") {
        c.addClass("on")
    } else {
        c.addClass("off")
    }
}

function backButtonInterval() {
    window.setInterval(function () {
        var e = $j(this).scrollTop();
        var f = $j(this).height();
        var a;
        if (e > 0) {
            a = e + f / 2
        } else {
            a = 1
        } if (a < 1000) {
            totop_button("off")
        } else {
            totop_button("on")
        }
    }, 300)
}

function backToTop() {
    $j(document).on("click", "#back_to_top", function (a) {
        a.preventDefault();
        $j("body,html").animate({
            scrollTop: 0
        }, $j(window).scrollTop() / 3, "swing")
    })
}

function fitVideo() {
    $j(".portfolio_images").fitVids();
    $j(".video_holder").fitVids()
}

function accordionFullWidth() {
    if ($j(".accordion.full_screen.yes")) {
        var b = $j(window).width();
        var a = -(b - 1000) / 2;
        if (b > 1000 && $j("div.full_width").length === 0) {
            $j(".accordion.full_screen.yes .accordion_inner").css({
                width: b,
                "margin-left": a,
                "margin-right": a
            });
            $j(".accordion.full_screen.yes .accordion_inner .accordion_content").css("padding", "0px 50px 30px")
        }
        if ($j("div.full_width").length > 0) {
            $j(".accordion.full_screen.yes .accordion_inner .accordion_content").css("padding", "0px 50px 30px")
        }
    }
}

function topAreaLine() {
    if ($j(".top_area_line_holder.yes")) {
        var b = $j(window).width();
        var a = -(b - 1000) / 2;
        if (b > 1000 && $j("div.full_width").length === 0) {
            $j(".top_area_line_holder.yes .top_area_line").css({
                width: b,
                "margin-left": a,
                "margin-right": a
            })
        }
    }
}

function viewPort() {
    $j(".parallax section").waypoint(function (a) {
        var b = $j(this).next();
        if (a === "up") {
            b = b.prev()
        }
        if (!b.length) {
            b = $j(this)
        }
        var c = b.attr("id");
        $j(".link").each(function () {
            var d = $j(this).attr("href").replace("#", "");
            if (d === c) {
                $j(this).addClass("active")
            } else {
                $j(this).removeClass("active")
            }
        })
    }, {
        offset: "0%"
    })
}

function initParallax(a) {
    $j(".parallax section").each(function () {
        var e = $j(this);
        var f = e.data("height");
        e.height(f);
        var b = (f / $j(document).height()) * a;
        var d = $j.elementoffset(e);
        var c = -(d * b);
        e.css({
            "background-position": "center " + c + "px"
        });
        $j(window).bind("scroll", function () {
            var h = $j.elementoffset(e);
            var g = -(h * b);
            e.css({
                "background-position": "center " + g + "px"
            })
        })
    });
    return this
}
$j.elementoffset = function (a) {
    var b = $j(window).scrollTop();
    return (b) - a.offset().top + 104
};

function parallaxPager() {
    var a = $j(".link_holder_parallax");
    $j("section.parallax section").each(function () {
        var d = $j(this).attr("id");
        var c = $j(this).data("title");
        var b = $j("<a />", {
            href: "#" + d,
            "class": "link",
            title: c,
            html: " "
        });
        b.appendTo(a)
    });
    a.css("margin-top", -a.height() / 2);
    $j(".link_holder_parallax .link:first-child").addClass("active");
    $j(document).on("click", "a.link", function () {
        $j(".tooltip").fadeOut(10);
        if ($j(this).hasClass("active")) {
            return false
        }
        $j(".link_holder_parallax .link").removeClass("active");
        $j(this).addClass("active");
        $j.scrollTo($j($j(this).attr("href")), {
            duration: 750,
            offset: {
                top: -1
            }
        });
        return false
    });
    $j(".link_holder_parallax a[title]").tooltip({
        position: "top left",
        offset: [20, -20]
    })
}

function selectBox() {
    $j("select").not(".gform_wrapper.gf_browser_chrome .ginput_complex select").sSelect();
    $j(".gform_wrapper.gf_browser_chrome .ginput_complex select").sSelect({
        ddMaxHeight: "300px"
    })
}

function initFadeDownEffect() {
    $j(".animate_list").each(function () {
        $j(this).appear(function () {
            $j(this).find("li").each(function (a) {
                var b = $j(this);
                setTimeout(function () {
                    b.animate({
                        opacity: 1,
                        top: 0
                    }, 1500)
                }, 100 * a)
            })
        }, {
            accX: 0,
            accY: -150
        })
    })
}(function (a) {
    a.fn.countTo = function (d) {
        d = a.extend({}, a.fn.countTo.defaults, d || {});
        var c = Math.ceil(d.speed / d.refreshInterval),
            b = (d.to - d.from) / c;
        return a(this).each(function () {
            var h = this,
                g = 0,
                i = d.from,
                e = setInterval(f, d.refreshInterval);

            function f() {
                i += b;
                g++;
                a(h).html(i.toFixed(d.decimals));
                if (typeof (d.onUpdate) === "function") {
                    d.onUpdate.call(h, i)
                }
                if (g >= c) {
                    clearInterval(e);
                    i = d.to;
                    if (typeof (d.onComplete) === "function") {
                        d.onComplete.call(h, i)
                    }
                }
            }
        })
    };
    a.fn.countTo.defaults = {
        from: 0,
        to: 100,
        speed: 3000,
        refreshInterval: 100,
        decimals: 0,
        onUpdate: null,
        onComplete: null,
    }
})(jQuery);

function initToCounter() {
    $j(".tocounter").each(function () {
        $j(this).appear(function () {
            var a = parseFloat($j(this).text());
            $j(this).countTo({
                from: 0,
                to: a,
                speed: 500,
                refreshInterval: 50
            })
        }, {
            accX: 0,
            accY: -150
        })
    })
}

function placeholderReplace() {
    $j("[placeholder]").focus(function () {
        var a = $j(this);
        if (a.val() === a.attr("placeholder")) {
            if (this.originalType) {
                this.type = this.originalType;
                delete this.originalType
            }
            a.val("");
            a.removeClass("placeholder")
        }
    }).blur(function () {
        var a = $j(this);
        if (a.val() === "") {
            if (this.type === "password") {
                this.originalType = this.type;
                this.type = "text"
            }
            a.addClass("placeholder");
            a.val(a.attr("placeholder"))
        }
    }).blur();
    $j("[placeholder]").parents("form").submit(function () {
        $j(this).find("[placeholder]").each(function () {
            var a = $j(this);
            if (a.val() === a.attr("placeholder")) {
                a.val("")
            }
        })
    })
}

function addPlaceholderSearchWidget() {
    $j(".header_right_widget #searchform input:text").each(function (a, b) {
        if (!b.value || b.value == "") {
            b.placeholder = "Search"
        }
    })
}

function prettyPhoto() {
    $j("a[data-rel]").each(function () {
        $j(this).attr("rel", $j(this).data("rel"))
    });
    $j("a[rel^='prettyPhoto']").prettyPhoto({
        animation_speed: "fast",
        slideshow: false,
        autoplay_slideshow: false,
        opacity: 0.8,
        show_title: true,
        allow_resize: true,
        default_width: 500,
        default_height: 344,
        counter_separator_label: "/",
        theme: "pp_default",
        hideflash: false,
        wmode: "opaque",
        autoplay: true,
        modal: false,
        overlay_gallery: false,
        keyboard_shortcuts: true,
        deeplinking: false,
        social_tools: false
    })
}

function checkLogOnSmallestSize() {
    if ($j(window).width() < 768) {
        if (logo_height >= 80) {
            $j(".logo a").height(70);
            $j(".logo").css("padding", "5px 0px 5px 0px")
        } else {
            var a = (80 - logo_height) / 2;
            $j(".logo").css("padding", a + "px 0px")
        }
    } else {
        $j(".logo").css("padding", "0px")
    }
}

function loadMore() {
    var a = 1;
    $j(".load_more a").on("click", function (g) {
        g.preventDefault();
        resetFilter();
        var d = $j(this).attr("href");
        var c = ".projects_holder";
        var h = ".portfolio_paging";
        var i = ".portfolio_paging .load_more a";
        var b = $j(i).attr("href");
        var f = $j(".projects_holder .filler").length;
        $j.get(d + "", function (k) {
            $j(".projects_holder .filler").slice(-f).remove();
            var e = $j(c, k).wrapInner("").html();
            b = $j(i, k).attr("href");
            $j("article.mix:last").after(e);
            var j = $j("article.mix:first").height();
            $j("article.mix").css("min-height", j);
            $j(".projects_holder").mixitup("remix", "all");
            prettyPhoto();
            $j(".projects_holder > .mix ").each(function () {
                $j(this).hoverdir()
            });
            if ($j(".load_more").attr("rel") > a) {
                $j(".load_more a").attr("href", b)
            } else {
                $j(".load_more").remove()
            }
            $j(".projects_holder .portfolio_paging:last").remove();
            $j("article.mix").css("min-height", 0)
        });
        a++
    })
}

function initAccordionContentLink() {
    $j(".accordion .accordion_content a").click(function (a) {
        if ($j(this).attr("target") === "_blank") {
            window.open($j(this).attr("href"), "_blank")
        } else {
            window.open($j(this).attr("href"), "_self")
        }
        return false
    });
    $j(".accordion_holder div.accordion_content_inner a").click(function (a) {
        if ($j(this).attr("target") === "_blank") {
            window.open($j(this).attr("href"), "_blank")
        } else {
            window.open($j(this).attr("href"), "_self")
        }
        return false
    })
};